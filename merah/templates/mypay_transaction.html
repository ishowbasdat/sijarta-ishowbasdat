{% extends 'base.html' %}

{% block content %}
{% include 'navbar.html' %}
<div class="min-h-screen flex flex-col items-center bg-gray-50 px-4 py-12 mt-9">
    <div class="max-w-5xl w-full bg-white p-8 rounded-xl shadow-lg">
        <h2 class="text-2xl font-semibold mb-6">MyPay Transaction</h2>

        <form method="POST" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            {% csrf_token %}

            <div class="mb-4">
                <label for="kategori" class="block text-gray-700 text-lg font-bold mb-2">Transaction Category</label>
                <select id="kategori" name="kategori" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="topup">TopUp</option>
                    {% if request.session.user.role == 'PELANGGAN' %}
                        <option value="pembayaran_jasa">Payment for Services</option>
                    {% endif %}
                    <option value="transfer">Transfer</option>
                    <option value="withdrawal">Withdrawal</option>
                </select>
            </div>

            <div id="transaction-details" class="mb-4">
                <!-- Transaction Details will be dynamically loaded here -->
            </div>

            <div class="flex justify-end">
                <button id="submitButton" type="submit" class="px-6 py-2 bg-green-500 text-white rounded hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-300">Pay</button>
            </div>
        </form>
    </div>
</div>


<script>
    const kategoriSelect = document.getElementById('kategori');
    const transactionDetails = document.getElementById('transaction-details');
    const submitButton = document.getElementById('submitButton');

    const transactionStates = {
        topup: `
            <div class="mb-4">
                <label for="nominal_topup" class="block text-gray-700 text-lg font-bold mb-2">TopUp Amount</label>
                <input type="number" id="nominal_topup" name="nominal_topup" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter amount" />
            </div>
        `,
        pembayaran_jasa: `
            <div class="mb-4">
                <label for="jasa" class="block text-gray-700 text-lg font-bold mb-2">Service</label>
                <select id="jasa" name="jasa" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="jasa1">Service 1</option>
                    <option value="jasa2">Service 2</option>
                    <option value="jasa3">Service 3</option>
                </select>

                <label for="harga_jasa" class="block text-gray-700 text-lg font-bold mb-2 mt-4">Price</label>
                <input type="text" id="harga_jasa" name="harga_jasa" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" value="Price" readonly />
            </div>
        `,
        transfer: `
            <div class="mb-4">
                <label for="no_hp_tujuan" class="block text-gray-700 text-lg font-bold mb-2">Recipient Phone Number</label>
                <input type="text" id="no_hp_tujuan" name="no_hp_tujuan" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter phone number" />

                <label for="nominal_transfer" class="block text-gray-700 text-lg font-bold mb-2 mt-4">Transfer Amount</label>
                <input type="number" id="nominal_transfer" name="nominal_transfer" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter amount" />
            </div>
        `,
        withdrawal: `
            <div class="mb-4">
                <label for="bank" class="block text-gray-700 text-lg font-bold mb-2">Bank</label>
                <select id="bank" name="bank" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="bca">BCA</option>
                    <option value="bni">BNI</option>
                    <option value="mandiri">Mandiri</option>
                </select>

                <label for="rekening" class="block text-gray-700 text-lg font-bold mb-2 mt-4">Account Number</label>
                <input type="text" id="rekening" name="rekening" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter account number" />

                <label for="nominal_withdrawal" class="block text-gray-700 text-lg font-bold mb-2 mt-4">Withdrawal Amount</label>
                <input type="number" id="nominal_withdrawal" name="nominal_withdrawal" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter amount" />
            </div>
        `
    };

    kategoriSelect.addEventListener('change', () => {
        const selectedCategory = kategoriSelect.value;
        transactionDetails.innerHTML = transactionStates[selectedCategory] || '';
        submitButton.textContent = selectedCategory === 'topup' ? 'Top Up' : 'Pay';
    });

    // Trigger initial display
    kategoriSelect.dispatchEvent(new Event('change'));
</script>

{% endblock %}